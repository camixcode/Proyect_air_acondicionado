{% extends "core/base.html" %}

{% block contenido %}

<script>
        $(function(){
                $("#form_buscar").on('submit',function(){
                    var formData = new FormData(this);
                    $.ajax({
                        url: "{% url 'post_buscar_producto' %}",
                        type:"POST",
                        data: formData,
                        processData: false,
                        contentType:false,
                        success: function(respuesta){
                            $("#nombre").val(respuesta.nombre);
                            $("#stock_disponible").val(respuesta.stock);
                            $("#precio_bruto").val(respuesta.precio_bruto);
                            $("#codigo_oculto").val(respuesta.codigo);
                            $("#fecha_entrega").val(respuesta.fecha_entrega);
                            $("#categoria").val(respuesta.categoria);
                        }
                    });
                    
                    return false;
        
                });
        
        
                $("#form_actualizar").on('submit',function(){
                    var formData = new FormData(this);
                    $.ajax({
                        url: "{% url 'post_actualizar_producto' %}",
                        type:"POST",
                        data: formData,
                        processData: false,
                        contentType:false,
                        success: function(respuesta){
                            var mensaje = respuesta.mensaje;
                            if(mensaje)
                                alert("Datos actualizados");
                            else        
                                alert("Error al actualizar");
                        }
                    });
                    
                    return false;
        
                });
        
        });        
        
        </script>



<h3>Consumo Cliente</h3>

<h3>Formulario -Consulta</h3>
<form method="post" id="form_buscar">
        {% csrf_token %}
        <div class="form-group">
                <span>Ingrese Código: </span>
                <input type="text" name="codigo" id="codigo">
                <button type="submit" class="btn btn-success">Obtener Libro</button>
        </div>
</form>

<br>
<form method="post" id="form_actualizar">
        {% csrf_token %}
        <div class="form-group">
                <span>Nombre del Libro: </span>
                <input type="text" name="nombre" id="nombre" readonly>
                <span>Stock disponible: </span>
                <input type="text" name="stock_disponible" id="stock_disponible" readonly>
                <span>Precio Bruto: </span>
               <input type="text" name="precio_bruto" id="precio_bruto" readonly>
                <span>Fecha Entrega: </span>
                <input type="text" name="fecha_entrega" id="fecha_entrega" readonly>
                <span>Categoria: </span>
                <input type="text" name="categoria" id="categoria" readonly>
                <span>Codigo Producto: </span>
                <input type="text" name="codigo_oculto" id="codigo_oculto" readonly>
                <br>
                <span>Ingrese cantidad a comprar: </span>
                <input type="text" name="stock" id="stock">
                <button type="submit" class="btn btn-success">Actualizar Stock Libro</button>
        </div>
</form>

{{mensaje}}


<table id="tabla_datos" data-toggle="table" data-sort-name="stargazers_count" data-sort-order="desc"
        data-pagination="true" data-height="460" data-unique-id="codigo_id" data-search="true">
        <thead class="thead-inverse">
                <th data-field="codigo_id">Código Producto </th>
                <th data-field="nombre">Nombre Producto </th>
                <th data-field="precio">Precio Bruto Producto </th>
                <th data-field="stock">Stock Producto </th>
                <th data-field="autor">Fecha entrega Producto </th>
                <th data-field="vigencia">Categoria Producto </th>
        </thead>
        <tbody>
                {% for pro in productos %}
                <tr>
                        <td>{{pro.id_producto}}</td>
                        <td>{{pro.nombre}}</td>
                        <td>{{pro.precio_bruto}}</td>
                        <td>{{pro.stock}}</td>f
                        <td>{{pro.fecha_entrega}}</td>
                        <td>{{pro.categoria}}</td>
                </tr>
                {% endfor %}


        </tbody>

</table>
{% endblock contenido %}